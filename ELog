

 

 

I wanted to pass on some information on one of the DBA’s
best friends. The SQL ERRORLOG. 

 

What is it?

The SQL errorlog contains information that is generated
by SQL Server.

 

What does it contain?

The SQL errorlog contains informational messages,
warnings, and information about critical events. The errorlog also contains
information about user-generated messages and auditing information such as
logon events. 

 

Where is it?

The SQL errorlog is typically found in “Program
Files\Microsoft SQL Server\MSSQL.n\MSSQL\LOG\ERRORLOG”

 

You can confirm the location by two different methods 

SQL
Configuration Manager – Open SQL Server Configuration Manager. Navigate to SQL
Server Services. Right-click SQL Server and go to properties. On the Advanced
Tab, navigate to the Startup Parameters and look at the “-e” parameter.SQL
query – Open new query window and run the following command: “xp_readerrorlog 0, 1, N'Logging SQL Server messages in file', NULL, NULL” You can access the error log in three different methods.







SQL
Server Management Studio – Within Object Explorer, navigate to Management,
expand SQL Server Logs.File
Explorer – Navigate to ERRORLOG.n files and open with Notepad or another text
editor.SQL
Query – Open new query window and run the following command: “xp_readerrorlog”  How do I manage the ERRORLOG?There are a number of things you want to do. Having a
large errorlog will make troubleshooting difficult and possibly cause space
issues. If a new errorlog cannot be generated, SQL will not start. The errorlog
will cycle during each SQL restart, which could leave you with no real data if
you don’t change the defaults. The driver to how you configure the SQL errorlog
should be based on the retention of how long you want to keep the data. For
example, if you want to keep 6 months of the errorlog logs, you may choose to
cycle weekly and keep 30 errorlogs. Below are a few things you can do to manage
the errorlog.  Increase the number of error logs. – https://support.microsoft.com/en-us/kb/196909SQL Query – 



















EXEC xp_instance_regwrite N'HKEY_LOCAL_MACHINE', 

N'Software\Microsoft\MSSQLServer\MSSQLServer', 

N'NumErrorLogs', REG_DWORD, 10

GO

 

Regularly cycle the error log. – https://msdn.microsoft.com/en-us/library/ms182512.aspx

SQL Query – 

sp_cycle_errorlog

 

 

Limit the size of each file. – http://www.sqlskills.com/blogs/paul/limiting-error-log-file-size-in-sql-server-2012/

SQL Query – 

EXEC xp_instance_regwrite N'HKEY_LOCAL_MACHINE', 

N'Software\Microsoft\MSSQLServer\MSSQLServer', 

N'ErrorLogSizeInKb', REG_DWORD, 5120;

GO

 

The next thing to consider are the events within the SQL
errorlog. Like mentioned above, you will have informational messages, warnings,
and information about critical events. With that being said, there will be lots
of ‘noise’. One of the easiest ways to sort through this would be to use the “xp_readerrorlog” query and import it into a
temporary table so that you can then filter the results. This will allow you to
either filter out what you don’t want to hear or filter what you want. See
query attached in email for an example.

 

Once you start filtering, you can really target the
messages that you are concerned about. Fixing some of these will help stabilize
your SQL Server. Some messages you will want to look for will be failed
backups, failed logins, deadlocks (with trace flag 1222), database recovery, or
SQL Errors. Some other specific errors would be “SQL Server has encountered <n> occurrence(s) of I/O requests
taking longer than 15 seconds to complete on file [<full path of
file>] in database [<database name.>] (<dbid>).” and
“Database dbName has more than n virtual log
files which is excessive. Too many virtual log files can cause long startup and
backup times.”. There are an almost infinite number or messages in
the errorlog, so I would suggest doing a little research on Bing (or another
search provider) or contacting myself.

 

 

Additional Links:

How to manage the SQL Server error log – https://support.microsoft.com/en-us/kb/2199578

SQL Server Error Severity Levels – https://msdn.microsoft.com/en-us/library/ms164086.aspx

I/O Error Message – https://support.microsoft.com/en-us/kb/2137408

VLF Error Message – https://support.microsoft.com/en-us/kb/2882905

Troubleshooting Deadlocks - https://technet.microsoft.com/en-us/library/ms178104.aspx

Failed Logins - https://support.microsoft.com/en-us/kb/555332

 

 

 

